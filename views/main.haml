%h2 Query
%form{:method => 'post'}
  %table
    %thead
      %tr
        %th Set
        %th Database
        %th Table
        %th Columns
        %th Where
        %th Order
    %tbody
      - %w{A B}.each do |set|
        %tr
          %td= set
          %td
            %select{:id => "set_#{set}_database", :name => "set[#{set}][database]"}
              %option/
              - @databases.each do |database|
                %option= database
          %td
            %select{:id => "set_#{set}_from", :name => "set[#{set}][from]"}/
          %td
            %input{:id => "set_#{set}_columns", :type => 'text', :name => "set[#{set}][columns]"}/
          %td
            %input{:type => 'text', :name => "set[#{set}][where]"}/
          %td
            %input{:type => 'text', :name => "set[#{set}][order]"}/
          %td
            %img{:id => "set_#{set}_spinner", :src => 'ajax-loader.gif', :style => 'display:none;'}/
  %p
    Join:
    %input{:type => 'text', :name => 'join'}/
    (Ex: A.MomSSN = B.SSN)
  %p
    %input{:type => 'submit', :value => 'Start'}/
    %img#query_spinner{:src => 'ajax-loader.gif', :style => 'display:none;'}/

#results

:javascript
  $(function() {
    $('#set_A_database, #set_B_database').change(function() { update_tables(this); });
    $('#set_A_from, #set_B_from').change(function() { update_columns(this); });
    $('form').submit(function() {
      $('#query_spinner').show();
      $.ajax({
        type: 'POST',
        url: '/query',
        data: $(this).serialize(),
        dataType: 'html',
        success: function(data) {
          $('#results').html(data);
          $('#query_spinner').hide();
        }
      });
      return false;
    });
  });
